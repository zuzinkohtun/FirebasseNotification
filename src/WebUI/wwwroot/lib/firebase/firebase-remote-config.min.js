import{registerVersion as e,_registerComponent as t,_getProvider,getApp as r,SDK_VERSION as n}from"https://www.gstatic.com/firebasejs/10.6.0/firebase-app.js";function isIndexedDBAvailable(){try{return"object"==typeof indexedDB}catch(e){return!1}}class FirebaseError extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name="FirebaseError",Object.setPrototypeOf(this,FirebaseError.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ErrorFactory.prototype.create)}}class ErrorFactory{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){var s,t=t[0]||{},r=this.service+"/"+e,e=this.errors[e],e=e?(s=t,e.replace(a,(e,t)=>{var r=s[t];return null!=r?String(r):`<${t}?>`})):"Error",e=this.serviceName+`: ${e} (${r}).`;return new FirebaseError(r,e,t)}}const a=/\{\$([^}]+)}/g;function calculateBackoffMillis(e,t=1e3,r=2){t*=Math.pow(r,e),r=Math.round(.5*t*(Math.random()-.5)*2);return Math.min(144e5,t+r)}function getModularInstance(e){return e&&e._delegate?e._delegate:e}class Component{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}var s;!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(s=s||{});const i={debug:s.DEBUG,verbose:s.VERBOSE,info:s.INFO,warn:s.WARN,error:s.ERROR,silent:s.SILENT},o=s.INFO,c={[s.DEBUG]:"log",[s.VERBOSE]:"log",[s.INFO]:"info",[s.WARN]:"warn",[s.ERROR]:"error"},defaultLogHandler=(e,t,...r)=>{if(!(t<e.logLevel)){var a=(new Date).toISOString(),s=c[t];if(!s)throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`);console[s](`[${a}]  ${e.name}:`,...r)}};class Logger{constructor(e){this.name=e,this._logLevel=o,this._logHandler=defaultLogHandler,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in s))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?i[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,s.DEBUG,...e),this._logHandler(this,s.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,s.VERBOSE,...e),this._logHandler(this,s.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,s.INFO,...e),this._logHandler(this,s.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,s.WARN,...e),this._logHandler(this,s.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,s.ERROR,...e),this._logHandler(this,s.ERROR,...e)}}let l,u;const g=new WeakMap,h=new WeakMap,d=new WeakMap,f=new WeakMap,p=new WeakMap;let m={get(e,t,r){if(e instanceof IDBTransaction){if("done"===t)return h.get(e);if("objectStoreNames"===t)return e.objectStoreNames||d.get(e);if("store"===t)return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return wrap(e[t])},set:(e,t,r)=>(e[t]=r,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function wrapFunction(r){return r!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(u=u||[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey]).includes(r)?function(...e){return r.apply(unwrap(this),e),wrap(g.get(this))}:function(...e){return wrap(r.apply(unwrap(this),e))}:function(e,...t){t=r.call(unwrap(this),e,...t);return d.set(t,e.sort?e.sort():[e]),wrap(t)}}function transformCachableValue(e){return"function"==typeof e?wrapFunction(e):(e instanceof IDBTransaction&&(n=e,h.has(n)||(t=new Promise((e,t)=>{const r=()=>{n.removeEventListener("complete",a),n.removeEventListener("error",s),n.removeEventListener("abort",s)},a=()=>{e(),r()},s=()=>{t(n.error||new DOMException("AbortError","AbortError")),r()};n.addEventListener("complete",a),n.addEventListener("error",s),n.addEventListener("abort",s)}),h.set(n,t))),r=e,(l=l||[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]).some(e=>r instanceof e)?new Proxy(e,m):e);var n,t,r}function wrap(e){if(e instanceof IDBRequest){var n=e;const r=new Promise((e,t)=>{const r=()=>{n.removeEventListener("success",a),n.removeEventListener("error",s)},a=()=>{e(wrap(n.result)),r()},s=()=>{t(n.error),r()};n.addEventListener("success",a),n.addEventListener("error",s)});return r.then(e=>{e instanceof IDBCursor&&g.set(e,n)}).catch(()=>{}),p.set(r,n),r}if(f.has(e))return f.get(e);var t=transformCachableValue(e);return t!==e&&(f.set(e,t),p.set(t,e)),t}const unwrap=e=>p.get(e),w=["get","getKey","getAll","getAllKeys","count"],v=["put","add","delete","clear"],E=new Map;function getMethod(e,t){if(e instanceof IDBDatabase&&!(t in e)&&"string"==typeof t){if(E.get(t))return E.get(t);const a=t.replace(/FromIndex$/,""),s=t!==a,n=v.includes(a);return a in(s?IDBIndex:IDBObjectStore).prototype&&(n||w.includes(a))?(e=async function(e,...t){e=this.transaction(e,n?"readwrite":"readonly");let r=e.store;return s&&(r=r.index(t.shift())),(await Promise.all([r[a](...t),n&&e.done]))[0]},E.set(t,e),e):void 0}}!function(e){m=e(m)}(a=>({...a,get:(e,t,r)=>getMethod(e,t)||a.get(e,t,r),has:(e,t)=>!!getMethod(e,t)||a.has(e,t)}));const y="@firebase/installations",I=new ErrorFactory("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function isServerError(e){return e instanceof FirebaseError&&e.code.includes("request-failed")}function getInstallationsEndpoint({projectId:e}){return`https://firebaseinstallations.googleapis.com/v1/projects/${e}/installations`}function extractAuthTokenInfoFromResponse(e){return{token:e.token,requestStatus:2,expiresIn:(e=e.expiresIn,Number(e.replace("s","000"))),creationTime:Date.now()}}async function getErrorFromResponse(e,t){t=(await t.json()).error;return I.create("request-failed",{requestName:e,serverCode:t.code,serverMessage:t.message,serverStatus:t.status})}function getHeaders({apiKey:e}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e})}function getHeadersWithAuth(e,{refreshToken:t}){const r=getHeaders(e);return r.append("Authorization","FIS_v2 "+t),r}async function retryIfServerError(e){var t=await e();return 500<=t.status&&t.status<600?e():t}function sleep(t){return new Promise(e=>{setTimeout(e,t)})}const b=/^[cdef][\w-]{21}$/;function generateFid(){try{const r=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(r),r[0]=112+r[0]%16;t=r;var e=btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_").substr(0,22);return b.test(e)?e:""}catch(e){return""}var t}function getKey(e){return e.appName+"!"+e.appId}const C=new Map;function fidChanged(e,t){e=getKey(e);callFidChangeCallbacks(e,t);{!S&&"BroadcastChannel"in self&&((S=new BroadcastChannel("[Firebase] FID Change")).onmessage=e=>{callFidChangeCallbacks(e.data.key,e.data.fid)});const r=S;return r&&r.postMessage({key:e,fid:t}),void(0===C.size&&S&&(S.close(),S=null))}}function callFidChangeCallbacks(e,t){var r=C.get(e);if(r)for(const e of r)e(t)}let S=null;const T="firebase-installations-store";let _=null;function getDbPromise(){return _=_||function(e,t,{blocked:r,upgrade:a,blocking:s,terminated:n}){const i=indexedDB.open(e,t),o=wrap(i);return a&&i.addEventListener("upgradeneeded",e=>{a(wrap(i.result),e.oldVersion,e.newVersion,wrap(i.transaction),e)}),r&&i.addEventListener("blocked",e=>r(e.oldVersion,e.newVersion,e)),o.then(e=>{n&&e.addEventListener("close",()=>n()),s&&e.addEventListener("versionchange",e=>s(e.oldVersion,e.newVersion,e))}).catch(()=>{}),o}("firebase-installations-database",1,{upgrade:(e,t)=>{0===t&&e.createObjectStore(T)}})}async function set(e,t){const r=getKey(e),a=(await getDbPromise()).transaction(T,"readwrite"),s=a.objectStore(T),n=await s.get(r);return await s.put(t,r),await a.done,n&&n.fid===t.fid||fidChanged(e,t.fid),t}async function remove(e){const t=getKey(e),r=(await getDbPromise()).transaction(T,"readwrite");await r.objectStore(T).delete(t),await r.done}async function update(e,t){const r=getKey(e),a=(await getDbPromise()).transaction(T,"readwrite"),s=a.objectStore(T),n=await s.get(r),i=t(n);return void 0===i?await s.delete(r):await s.put(i,r),await a.done,!i||n&&n.fid===i.fid||fidChanged(e,i.fid),i}async function getInstallationEntry(t){let r;var e=await update(t.appConfig,e=>{e=clearTimedOutRequest(e||{fid:generateFid(),registrationStatus:0}),e=function(e,t){if(0!==t.registrationStatus)return 1===t.registrationStatus?{installationEntry:t,registrationPromise:waitUntilFidRegistration(e)}:{installationEntry:t};if(!navigator.onLine)return{installationEntry:t,registrationPromise:Promise.reject(I.create("app-offline"))};t={fid:t.fid,registrationStatus:1,registrationTime:Date.now()};return{installationEntry:t,registrationPromise:async function(t,r){try{var e=await async function({appConfig:e,heartbeatServiceProvider:t},{fid:r}){const a=getInstallationsEndpoint(e),s=getHeaders(e),n=t.getImmediate({optional:!0});if(n){const e=await n.getHeartbeatsHeader();e&&s.append("x-firebase-client",e)}const i={fid:r,authVersion:"FIS_v2",appId:e.appId,sdkVersion:"w:0.6.4"},o={method:"POST",headers:s,body:JSON.stringify(i)},c=await retryIfServerError(()=>fetch(a,o));if(c.ok){const e=await c.json();return{fid:e.fid||r,registrationStatus:2,refreshToken:e.refreshToken,authToken:extractAuthTokenInfoFromResponse(e.authToken)}}throw await getErrorFromResponse("Create Installation",c)}(t,r);return set(t.appConfig,e)}catch(e){throw isServerError(e)&&409===e.customData.serverCode?await remove(t.appConfig):await set(t.appConfig,{fid:r.fid,registrationStatus:0}),e}}(e,t)}}(t,e);return r=e.registrationPromise,e.installationEntry});return""===e.fid?{installationEntry:await r}:{installationEntry:e,registrationPromise:r}}async function waitUntilFidRegistration(e){let t=await updateInstallationRequest(e.appConfig);for(;1===t.registrationStatus;)await sleep(100),t=await updateInstallationRequest(e.appConfig);if(0!==t.registrationStatus)return t;{const{installationEntry:t,registrationPromise:r}=await getInstallationEntry(e);return r||t}}function updateInstallationRequest(e){return update(e,e=>{if(e)return clearTimedOutRequest(e);throw I.create("installation-not-found")})}function clearTimedOutRequest(e){return 1===(t=e).registrationStatus&&t.registrationTime+1e4<Date.now()?{fid:e.fid,registrationStatus:0}:e;var t}async function generateAuthTokenRequest({appConfig:e,heartbeatServiceProvider:t},r){[i,o]=[e,r["fid"]];const a=getInstallationsEndpoint(i)+`/${o}/authTokens:generate`,s=getHeadersWithAuth(e,r),n=t.getImmediate({optional:!0});var i,o;if(n){const e=await n.getHeartbeatsHeader();e&&s.append("x-firebase-client",e)}const c={installation:{sdkVersion:"w:0.6.4",appId:e.appId}},l={method:"POST",headers:s,body:JSON.stringify(c)},u=await retryIfServerError(()=>fetch(a,l));if(u.ok)return extractAuthTokenInfoFromResponse(await u.json());throw await getErrorFromResponse("Generate Auth Token",u)}async function refreshAuthToken(s,n=!1){let i;var e=await update(s.appConfig,e=>{if(!isEntryRegistered(e))throw I.create("not-registered");var t,r,a=e.authToken;if(!(n||(2!==(t=a).requestStatus||(t=t,(r=Date.now())<t.creationTime||t.creationTime+t.expiresIn<r+36e5))))return e;if(1===a.requestStatus)return i=async function(e,t){let r=await updateAuthTokenRequest(e.appConfig);for(;1===r.authToken.requestStatus;)await sleep(100),r=await updateAuthTokenRequest(e.appConfig);var a=r.authToken;return 0===a.requestStatus?refreshAuthToken(e,t):a}(s,n),e;{if(!navigator.onLine)throw I.create("app-offline");t=e,r={requestStatus:1,requestTime:Date.now()};const n=Object.assign(Object.assign({},t),{authToken:r});return i=async function(t,r){try{var e=await generateAuthTokenRequest(t,r),a=Object.assign(Object.assign({},r),{authToken:e});return await set(t.appConfig,a),e}catch(e){throw!isServerError(e)||401!==e.customData.serverCode&&404!==e.customData.serverCode?(a=Object.assign(Object.assign({},r),{authToken:{requestStatus:0}}),await set(t.appConfig,a)):await remove(t.appConfig),e}}(s,n),n}});return i?await i:e.authToken}function updateAuthTokenRequest(e){return update(e,e=>{if(isEntryRegistered(e))return 1===(t=e.authToken).requestStatus&&t.requestTime+1e4<Date.now()?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e;throw I.create("not-registered");var t})}function isEntryRegistered(e){return void 0!==e&&2===e.registrationStatus}async function getToken(e,t=!1){var r=e;return(r=(await getInstallationEntry(r)).registrationPromise)&&await r,await 0,(await refreshAuthToken(e,t)).token}function getMissingValueError(e){return I.create("missing-app-config-values",{valueName:e})}const publicFactory=e=>{e=e.getProvider("app").getImmediate();return{app:e,appConfig:function(e){if(!e||!e.options)throw getMissingValueError("App Configuration");if(!e.name)throw getMissingValueError("App Name");for(const t of["projectId","apiKey","appId"])if(!e.options[t])throw getMissingValueError(t);return{appName:e.name,projectId:e.options.projectId,apiKey:e.options.apiKey,appId:e.options.appId}}(e),heartbeatServiceProvider:_getProvider(e,"heartbeat"),_delete:()=>Promise.resolve()}},internalFactory=e=>{const t=e.getProvider("app").getImmediate(),r=_getProvider(t,"installations").getImmediate();return{getId:()=>async function(e){const t=e,{installationEntry:r,registrationPromise:a}=await getInstallationEntry(t);return(a||refreshAuthToken(t)).catch(console.error),r.fid}(r),getToken:e=>getToken(r,e)}},F=(t(new Component("installations",publicFactory,"PUBLIC")),t(new Component("installations-internal",internalFactory,"PRIVATE")),e(y,"0.6.4"),e(y,"0.6.4","esm2017"),"@firebase/remote-config");class RemoteConfigAbortSignal{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}const M=new ErrorFactory("remoteconfig","Remote Config",{"registration-window":"Undefined window object. This SDK only supports usage in a browser environment.","registration-project-id":"Undefined project identifier. Check Firebase app initialization.","registration-api-key":"Undefined API key. Check Firebase app initialization.","registration-app-id":"Undefined app identifier. Check Firebase app initialization.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}.","fetch-client-network":"Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-timeout":'The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',"fetch-throttle":'The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',"fetch-client-parse":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","indexed-db-unavailable":"Indexed DB is not supported by current browser"}),k=["1","true","t","yes","y","on"];class Value{constructor(e,t=""){this._source=e,this._value=t}asString(){return this._value}asBoolean(){return"static"!==this._source&&0<=k.indexOf(this._value.toLowerCase())}asNumber(){if("static"===this._source)return 0;let e=Number(this._value);return e=isNaN(e)?0:e}getSource(){return this._source}}function getRemoteConfig(e=r()){return e=getModularInstance(e),_getProvider(e,"remote-config").getImmediate()}async function activate(e){const t=getModularInstance(e),[r,a]=await Promise.all([t._storage.getLastSuccessfulFetchResponse(),t._storage.getActiveConfigEtag()]);return!!(r&&r.config&&r.eTag&&r.eTag!==a)&&(await Promise.all([t._storageCache.setActiveConfig(r.config),t._storage.setActiveConfigEtag(r.eTag)]),!0)}function ensureInitialized(e){const t=getModularInstance(e);return t._initializePromise||(t._initializePromise=t._storageCache.loadFromStorage().then(()=>{t._isInitializationComplete=!0})),t._initializePromise}async function fetchConfig(e){const t=getModularInstance(e),r=new RemoteConfigAbortSignal;setTimeout(async()=>{r.abort()},t.settings.fetchTimeoutMillis);try{await t._client.fetch({cacheMaxAgeMillis:t.settings.minimumFetchIntervalMillis,signal:r}),await t._storageCache.setLastFetchStatus("success")}catch(e){s="fetch-throttle";const r=(a=e)instanceof FirebaseError&&-1!==a.code.indexOf(s)?"throttle":"failure";throw await t._storageCache.setLastFetchStatus(r),e}var a,s}function getAll(r){const e=getModularInstance(r);return[t={},a={}]=[e._storageCache.getActiveConfig(),e.defaultConfig],Object.keys(Object.assign(Object.assign({},t),a)).reduce((e,t)=>(e[t]=getValue(r,t),e),{});var t,a}function getBoolean(e,t){return getValue(getModularInstance(e),t).asBoolean()}function getNumber(e,t){return getValue(getModularInstance(e),t).asNumber()}function getString(e,t){return getValue(getModularInstance(e),t).asString()}function getValue(e,t){const r=getModularInstance(e);r._isInitializationComplete||r._logger.debug(`A value was requested for key "${t}" before SDK initialization completed. Await on ensureInitialized if the intent was to get a previously activated value.`);e=r._storageCache.getActiveConfig();return e&&void 0!==e[t]?new Value("remote",e[t]):r.defaultConfig&&void 0!==r.defaultConfig[t]?new Value("default",String(r.defaultConfig[t])):(r._logger.debug(`Returning static value for key "${t}". Define a default or remote value if this is unintentional.`),new Value("static"))}function setLogLevel(e,t){const r=getModularInstance(e);switch(t){case"debug":r._logger.logLevel=s.DEBUG;break;case"silent":r._logger.logLevel=s.SILENT;break;default:r._logger.logLevel=s.ERROR}}class CachingClient{constructor(e,t,r,a){this.client=e,this.storage=t,this.storageCache=r,this.logger=a}isCachedDataFresh(e,t){if(!t)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;var t=Date.now()-t,r=t<=e;return this.logger.debug(`Config fetch cache check. Cache age millis: ${t}. Cache max age millis (minimumFetchIntervalMillis setting): ${e}. Is cache hit: ${r}.`),r}async fetch(e){var[t,r]=await Promise.all([this.storage.getLastSuccessfulFetchTimestampMillis(),this.storage.getLastSuccessfulFetchResponse()]);if(r&&this.isCachedDataFresh(e.cacheMaxAgeMillis,t))return r;e.eTag=r&&r.eTag;const a=await this.client.fetch(e),s=[this.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())];return 200===a.status&&s.push(this.storage.setLastSuccessfulFetchResponse(a)),await Promise.all(s),a}}function getUserLanguage(e=navigator){return e.languages&&e.languages[0]||e.language}class RestClient{constructor(e,t,r,a,s,n){this.firebaseInstallations=e,this.sdkVersion=t,this.namespace=r,this.projectId=a,this.apiKey=s,this.appId=n}async fetch(r){var[e,t]=await Promise.all([this.firebaseInstallations.getId(),this.firebaseInstallations.getToken()]),a=`${window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com"}/v1/projects/${this.projectId}/namespaces/${this.namespace}:fetch?key=`+this.apiKey,s={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":r.eTag||"*"},e={sdk_version:this.sdkVersion,app_instance_id:e,app_instance_id_token:t,app_id:this.appId,language_code:getUserLanguage()},t={method:"POST",headers:s,body:JSON.stringify(e)},s=fetch(a,t),e=new Promise((e,t)=>{r.signal.addEventListener(()=>{const e=new Error("The operation was aborted.");e.name="AbortError",t(e)})});let n;try{await Promise.race([s,e]),n=await s}catch(r){let e="fetch-client-network";throw"AbortError"===(null==r?void 0:r.name)&&(e="fetch-timeout"),M.create(e,{originalErrorMessage:null==r?void 0:r.message})}let i=n.status;a=n.headers.get("ETag")||void 0;let o,c;if(200===n.status){let e;try{e=await n.json()}catch(r){throw M.create("fetch-client-parse",{originalErrorMessage:null==r?void 0:r.message})}o=e.entries,c=e.state}if("INSTANCE_STATE_UNSPECIFIED"===c?i=500:"NO_CHANGE"===c?i=304:"NO_TEMPLATE"!==c&&"EMPTY_CONFIG"!==c||(o={}),304!==i&&200!==i)throw M.create("fetch-status",{httpStatus:i});return{status:i,eTag:a,config:o}}}class RetryingClient{constructor(e,t){this.client=e,this.storage=t}async fetch(e){var t=await this.storage.getThrottleMetadata()||{backoffCount:0,throttleEndTimeMillis:Date.now()};return this.attemptFetch(e,t)}async attemptFetch(e,{throttleEndTimeMillis:t,backoffCount:r}){var s,n;s=e.signal,n=t,await new Promise((e,t)=>{const r=Math.max(n-Date.now(),0),a=setTimeout(e,r);s.addEventListener(()=>{clearTimeout(a),t(M.create("fetch-throttle",{throttleEndTimeMillis:n}))})});try{const t=await this.client.fetch(e);return await this.storage.deleteThrottleMetadata(),t}catch(t){if(!function(e){if(e instanceof FirebaseError&&e.customData)return e=Number(e.customData.httpStatus),429===e||500===e||503===e||504===e}(t))throw t;r={throttleEndTimeMillis:Date.now()+calculateBackoffMillis(r),backoffCount:r+1};return await this.storage.setThrottleMetadata(r),this.attemptFetch(e,r)}}}class RemoteConfig{constructor(e,t,r,a,s){this.app=e,this._client=t,this._storageCache=r,this._storage=a,this._logger=s,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:6e4,minimumFetchIntervalMillis:432e5},this.defaultConfig={}}get fetchTimeMillis(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1}get lastFetchStatus(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"}}function toFirebaseError(e,t){e=e.target.error||void 0;return M.create(t,{originalErrorMessage:e&&(null==e?void 0:e.message)})}class Storage{constructor(e,t,r,a=function(){return new Promise((t,r)=>{try{const e=indexedDB.open("firebase_remote_config",1);e.onerror=e=>{r(toFirebaseError(e,"storage-open"))},e.onsuccess=e=>{t(e.target.result)},e.onupgradeneeded=e=>{const t=e.target.result;0===e.oldVersion&&t.createObjectStore("app_namespace_store",{keyPath:"compositeKey"})}}catch(t){r(M.create("storage-open",{originalErrorMessage:null==t?void 0:t.message}))}})}()){this.appId=e,this.appName=t,this.namespace=r,this.openDbPromise=a}getLastFetchStatus(){return this.get("last_fetch_status")}setLastFetchStatus(e){return this.set("last_fetch_status",e)}getLastSuccessfulFetchTimestampMillis(){return this.get("last_successful_fetch_timestamp_millis")}setLastSuccessfulFetchTimestampMillis(e){return this.set("last_successful_fetch_timestamp_millis",e)}getLastSuccessfulFetchResponse(){return this.get("last_successful_fetch_response")}setLastSuccessfulFetchResponse(e){return this.set("last_successful_fetch_response",e)}getActiveConfig(){return this.get("active_config")}setActiveConfig(e){return this.set("active_config",e)}getActiveConfigEtag(){return this.get("active_config_etag")}setActiveConfigEtag(e){return this.set("active_config_etag",e)}getThrottleMetadata(){return this.get("throttle_metadata")}setThrottleMetadata(e){return this.set("throttle_metadata",e)}deleteThrottleMetadata(){return this.delete("throttle_metadata")}async get(s){const n=await this.openDbPromise;return new Promise((t,r)=>{const e=n.transaction(["app_namespace_store"],"readonly").objectStore("app_namespace_store"),a=this.createCompositeKey(s);try{const s=e.get(a);s.onerror=e=>{r(toFirebaseError(e,"storage-get"))},s.onsuccess=e=>{e=e.target.result;t(e?e.value:void 0)}}catch(e){r(M.create("storage-get",{originalErrorMessage:null==e?void 0:e.message}))}})}async set(s,n){const i=await this.openDbPromise;return new Promise((e,t)=>{const r=i.transaction(["app_namespace_store"],"readwrite").objectStore("app_namespace_store"),a=this.createCompositeKey(s);try{const s=r.put({compositeKey:a,value:n});s.onerror=e=>{t(toFirebaseError(e,"storage-set"))},s.onsuccess=()=>{e()}}catch(e){t(M.create("storage-set",{originalErrorMessage:null==e?void 0:e.message}))}})}async delete(s){const n=await this.openDbPromise;return new Promise((e,t)=>{const r=n.transaction(["app_namespace_store"],"readwrite").objectStore("app_namespace_store"),a=this.createCompositeKey(s);try{const s=r.delete(a);s.onerror=e=>{t(toFirebaseError(e,"storage-delete"))},s.onsuccess=()=>{e()}}catch(e){t(M.create("storage-delete",{originalErrorMessage:null==e?void 0:e.message}))}})}createCompositeKey(e){return[this.appId,this.appName,this.namespace,e].join()}}class StorageCache{constructor(e){this.storage=e}getLastFetchStatus(){return this.lastFetchStatus}getLastSuccessfulFetchTimestampMillis(){return this.lastSuccessfulFetchTimestampMillis}getActiveConfig(){return this.activeConfig}async loadFromStorage(){var e=this.storage.getLastFetchStatus(),t=this.storage.getLastSuccessfulFetchTimestampMillis(),r=this.storage.getActiveConfig(),e=await e,e=(e&&(this.lastFetchStatus=e),await t),t=(e&&(this.lastSuccessfulFetchTimestampMillis=e),await r);t&&(this.activeConfig=t)}setLastFetchStatus(e){return this.lastFetchStatus=e,this.storage.setLastFetchStatus(e)}setLastSuccessfulFetchTimestampMillis(e){return this.lastSuccessfulFetchTimestampMillis=e,this.storage.setLastSuccessfulFetchTimestampMillis(e)}setActiveConfig(e){return this.activeConfig=e,this.storage.setActiveConfig(e)}}async function fetchAndActivate(e){return await fetchConfig(e=getModularInstance(e)),activate(e)}async function isSupported(){if(!isIndexedDBAvailable())return!1;try{return await new Promise((t,r)=>{try{let e=!0;const a="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(a);s.onsuccess=()=>{s.result.close(),e||self.indexedDB.deleteDatabase(a),t(!0)},s.onupgradeneeded=()=>{e=!1},s.onerror=()=>{var e;r((null==(e=s.error)?void 0:e.message)||"")}}catch(t){r(t)}})}catch(e){return!1}}t(new Component("remote-config",function(e,{instanceIdentifier:t}){var r=e.getProvider("app").getImmediate(),e=e.getProvider("installations-internal").getImmediate();if("undefined"==typeof window)throw M.create("registration-window");if(!isIndexedDBAvailable())throw M.create("indexed-db-unavailable");var{projectId:a,apiKey:i,appId:o}=r.options;if(!a)throw M.create("registration-project-id");if(!i)throw M.create("registration-api-key");if(!o)throw M.create("registration-app-id");t=t||"firebase";const c=new Storage(o,r.name,t),l=new StorageCache(c),u=new Logger(F);u.logLevel=s.ERROR;e=new RestClient(e,n,t,a,i,o),t=new RetryingClient(e,c),a=new CachingClient(t,c,l,u),i=new RemoteConfig(r,a,l,c,u);return ensureInitialized(i),i},"PUBLIC").setMultipleInstances(!0)),e(F,"0.4.4"),e(F,"0.4.4","esm2017");export{activate,ensureInitialized,fetchAndActivate,fetchConfig,getAll,getBoolean,getNumber,getRemoteConfig,getString,getValue,isSupported,setLogLevel};